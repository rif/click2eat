{% extends "base.html" %}
{% load i18n %}

{% block scripts %}
<script src="{{ MEDIA_URL }}js/jquery.timers.js" type="text/javascript"></script>
<script type="text/javascript">
    $(function(){
        $("body").everyTime(1000*5,function(i) { //every 5 seconds
          var platinum = $("#platinum-units");
          var gold = $("#gold-units");
          
          platinum.fadeOut('slow')
          platinum.load("{% url restaurant:get_random_platinum %}", function(){platinum.fadeIn();});
      
          gold.fadeOut('slow')
          gold.load("{% url restaurant:get_random_gold %}", function(){gold.fadeIn();});
        });
        $("#notrated-link").click(function(e){
           $("#notrated-orders").slideToggle();
           e.preventDefault();
        });
    });
</script>
{% endblock %}

{% block content %}
{% with user.get_profile.get_not_rated as order_list %}
{% if order_list.exists %}
<a id="notrated-link" href="#">{% trans 'You have not rated orders' %}</a>
<div id="notrated-orders" style="display:none">
  <p><b>{% trans 'Orders that still need your feedback' %}</b></p>
  <ul>
    {% for order in order_list %}
    <li><a href="{% url order:feedback order.id %}">{{ order }}</a></li>
    {% endfor %}
  </ul>
</div>{% endif %}
{% endwith %}

<form action="{% url menu:item_list %}" method="get">
  <p><label for="id_q">{% trans 'Search' %}:</label> <input type="text" name="q" id="id_q" value="{{ query }}" />
  {{ filter.form.as_p }}
  <input type="{% trans 'Submit' %}" />
</form>

<h3>Platinum</h3>
<div id="platinum-units">
    {% include 'restaurant/platinum_restaurant_list.html' %}
</div>
<h3>Gold</h3>
<div id="gold-units">
    {% include 'restaurant/gold_restaurant_list.html' %}
</div>
<p>
</p>
<h3>Silver</h3>
<div id="silver-units">
    {% include 'restaurant/silver_restaurant_list.html' %}
</div>
{% endblock %}
