{% extends "base.html" %}
{% load i18n %}

{% block title %}{{ object.name }}{% endblock %}

{% block style %}
    <link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/tabs_style.css"/>
{% endblock %}

{% block scripts %}
    <script type="text/javascript">
        $(function() {
            $(".add-item").click(function(e) {
                var selected_cart = $(".current", ".css-tabs").attr("id");
                $.get("/order/add_item/" + $(this).attr("id") + "/" + selected_cart, function(response) {
                    $(".css-panes>div").load("/order/get_cart/{{ order.id }}/" + selected_cart);
                    getAvailableToppings();
                });
                e.preventDefault();
            });
	    $(".add-motd").click(function(e) {
                var selected_cart = $(".current", ".css-tabs").attr("id");
                $.get("/order/add_motd/" + $(this).attr("id") + "/" + selected_cart, function(response) {
                    $(".css-panes>div").load("/order/get_cart/{{ order.id }}/" + selected_cart);
                    getAvailableToppings();
                });
                e.preventDefault();
            });
            $(".add-topping").click(function(e) {
                var selected_cart = $(".current", ".css-tabs").attr("id");
                $.get("/order/add_topping/" + $(this).attr("href") + "/" + $(this).attr("id") + "/" + selected_cart, function(response) {
                    $(".css-panes>div").load("/order/get_cart/{{ order.id }}/" + selected_cart);
                    getAvailableToppings();
                });
                e.preventDefault();
            });
            $("#carts>ul.css-tabs").tabs("div.css-panes > div", {effect: 'ajax'});
            $("#add-cart").click(function(e) {
                if ($("#id_name").length == 0) { // we don't have one already
                    $.get("{% url order:add_cart order.id %}", function(data) {
                        $("#carts>ul").append(data);
                        $("#id_name").focus();
                    });
                }
                e.preventDefault();
            });
            $("#last-orders").load("{% url order:list_unit object.id %}", function() {
                pageLinks();
            });
            $(".toggle-toppings").click(function(e) {
                $(this).next().slideToggle();
                e.preventDefault();
            });
            getAvailableToppings();
            $("#show-previous-link").click(function(e) {
                $("#last-orders").toggle();
                e.preventDefault();
            })
        });
        function pageLinks() {
            $(".page, .next, .prev").click(function(e) {
                $.get("{% url order:list_unit object.id %}" + $(this).attr("href"), function(data) {
                    $("#last-orders").html(data);
                    pageLinks();
                });
                e.preventDefault();
            });
        }
        function getAvailableToppings() {
            $.get("{% url order:available_toppings object.id %}", function(data) {
                var json = eval(data);
                $(".top-span").each(function() {
                    if ($.inArray($(this).attr("id"), json.items) != -1) {
                        $(this).show();
                    } else {
                        $(this).hide();
                    }
                });
            });
        }
        function addCartName() {
            $("#cart-name-form").submit(function() {
                var $action = $("#cart-name-form").attr("action");
                $.post($action,
                { csrfmiddlewaretoken:  $("input[name='csrfmiddlewaretoken']").val(),
                    name:                   $("#id_name").val(),
                }, function(data) {
                    var tabs_obj = $("#carts>ul.css-tabs");
                    $("#new-cart").replaceWith(data);
                    tabs_obj.tabs("div.css-panes > div", {effect: 'ajax'});
                    var api = tabs_obj.data("tabs");
                    var tabs_nb = $("li", tabs_obj).size() - 1;
                    api.click(tabs_nb);
                });
                return false;
            });
        }
    </script>
{% endblock %}

{% block content %}
    {% if motd %}
        <div class="content_area720">
            <div class="title"><h1 class="light_orange">{% trans 'Menu of the day' %}</h1></div>
            <h2><a id="{{ motd.id }}" class="add-motd" href="#">{{ motd.name }}</a></h2>
            {{ motd.description|safe }}
        </div><!-- content_area -->
    {% endif %}
    <div class="content_area720">
    <div id="paginarestaurant">
        <div class="title"><h1 class="light_orange">{% trans 'LISTA MENIU FARELLIS' %}</h1></div>
        <div class="establishment-menu">
            {% for itemgroup in object.itemgroup_set.iterator %}
                {% if itemgroup.active %}
                    <div class="category">
                        <h3><i><a href="#">{{ itemgroup }}</a></i></h3>   
                    </div> <!-- category -->
                {% endif %}
            {% endfor %}
        </div> <!-- estabilshment-menu -->
        <div class="clear"></div>
        <div class="establishment-menu">
            {% for itemgroup in object.itemgroup_set.iterator %}
                {% if itemgroup.active %}
                    <ul>
                        {% for item in itemgroup.item_set.iterator %}
                            {% if item.active %}
                                <li class="{% cycle 'even' 'odd' %} item {% if item.is_new %}new-item{% endif %} pozrel">
                                    <div class="name"><a id="{{ item.id }}" href="#"
                                                         class="add-item">{{ item.name_def }}</a></div>
                                    <div class="description">{{ item.description_def }}</div>
                                    <div class="price">
                                    {{ item.get_price }} {% trans 'lei' %}
                                    	<a href="#" title="" class="btncomanda">Adauga la comanda</a>
                                    </div>
                                    <div class="clear"></div>
                                </li>
                                <div class="clear"></div>

                                <span id="top{{ item.id }}" class="top-span" style="display:none">
                                    {% if item.toppings %}
                                        <a class="toggle-toppings" href="#"
                                           title="{% trans 'Toggle toppings' %}"><img alt="+" src="{{ MEDIA_URL }}images/template/plate_plus_btn.png" /></a>
                                        <span class="topping-span" style="display:none">
                                            {% trans 'Toppings' %}:
                                            <ul>
                                                {% for top in item.toppings.topping_set.iterator %}
                                                    <li>
                                                        <div class="name"><a id="{{ top.id }}" href="{{ item.id }}"
                                                                             class="add-topping">{{ top.name_def }}</a>
                                                        </div>
                                                        <div class="description">{{ top.description_def }}</div>
                                                    </li>
                                                {% endfor %}
                                            </ul>
                                        </span>
                                    {% endif %}
                                </span>
                            {% endif %}
                        {% empty %}
                            <li>{% trans 'No items in this group' %}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
                {% cycle '' '' '<div class="clear"></div>' %}
            {% endfor %}
            {% if forloop.counter < 3 %}
                <div class="clear"></div>
            {% endif %}
        </div> <!-- estabilshment-menu -->
    </div>
    </div><!-- content_area -->
    
    
    
    <!-- pagina de meniu lista generala, headerul cu platourile il gasesti in pagina "cum comand" e acelasi, doar la imagini schimbi dimensiunea -->
    <div class="clear"></div>
    <br/><br/>
<div class="content_area720"> 
	<div id="paginarestaurant">  
	<div class="title"><h1 class="light_orange">{% trans 'LISTA GENERALA MENIURI CLICK2EAT' %}</h1></div>
    <div class="lista">
        <div class="item pozrel">
        	<div class="book">
            	<a href="#" title="">
                	<span class="heading">SUPE</span>
                	<img src="{{ MEDIA_URL }}images/template/booksoup.png" />
                </a>
            </div>
            <div class="name"><a class="add-item" href="#" id="7">Meniuri supe si ciorbe</a></div>
            <div class="description2">Supe crema<br/>Supe vegetariene<br/>Supe cu carne</div>
          	<div class="click2eat">
            	<span class="recom">Recomandari supe si ciorbe</span>
            <div class="restaurante">
            	RESTAURANT <strong>PRESIDENT</strong><br/>
                RESTAURANT <strong>ALEXANDRE</strong>
            </div>
            </div>
            <div class="clear"></div>
        </div>      
        <div class="item pozrel">
        	<div class="book">
            	<a href="#" title="">
                	<span class="heading">PIZZA</span>
                	<img src="{{ MEDIA_URL }}images/template/bookpizza.png" />
                </a>
            </div>
            <div class="name"><a class="add-item" href="#" id="8">Meniuri Pizza</a></div>
            <div class="description2">Pizza vegetariana<br/>Pizza normala<br/>Pizza picanta</div>
          	<div class="click2eat">
            	<span class="recom">Recomandari pizza</span>
            <div class="restaurante">
            	RESTAURANT <strong>PRESIDENT</strong><br/>
                RESTAURANT <strong>ALEXANDRE</strong>
            </div>
            </div>
           <div class="clear"></div>
        </div>
        <div class="item pozrel">
        	<div class="book">
            	<a href="#" title="">
                	<span class="heading">PASTE</span>
                	<img src="{{ MEDIA_URL }}images/template/bookpasta.png" />
                </a>
            </div>
            <div class="name"><a class="add-item" href="#" id="7">Meniuri paste</a></div>
            <div class="description2">Spaghetti<br/> Penne Tortellini<br/> Lasagna <br/>Paste speciale</div>
          	<div class="click2eat">
            	<span class="recom">Recomandari supe si ciorbe</span>
            <div class="restaurante">
            	RESTAURANT <strong>PRESIDENT</strong><br/>
                RESTAURANT <strong>ALEXANDRE</strong>
            </div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="item pozrel">
        	<div class="book">
            	<a href="#" title="">
                	<span class="heading">SALATE</span>
                	<img src="{{ MEDIA_URL }}images/template/booksalad.png" />
                </a>
            </div>
            <div class="name"><a class="add-item" href="#" id="7">Meniuri salate</a></div>
            <div class="description2">Supe crema<br/>Supe vegetariene<br/>Supe cu carne</div>
          	<div class="click2eat">
            	<span class="recom">Recomandari supe si ciorbe</span>
            <div class="restaurante">
            	RESTAURANT <strong>PRESIDENT</strong><br/>
                RESTAURANT <strong>ALEXANDRE</strong>
            </div>
            </div>
            <div class="clear"></div>
        </div>      
        <div class="item pozrel">
        	<div class="book">
            	<a href="#" title="">
                	<span class="heading">PRINCIPAL</span>
                	<img src="{{ MEDIA_URL }}images/template/bookmain.png" />
                </a>
            </div>
            <div class="name"><a class="add-item" href="#" id="7">Meniuri principal</a></div>
            <div class="description2">Supe crema<br/>Supe vegetariene<br/>Supe cu carne</div>
          	<div class="click2eat">
            	<span class="recom">Recomandari supe si ciorbe</span>
            <div class="restaurante">
            	RESTAURANT <strong>PRESIDENT</strong><br/>
                RESTAURANT <strong>ALEXANDRE</strong>
            </div>
            </div>
            <div class="clear"></div>
        </div>
        <div class="item pozrel">
        	<div class="book">
            	<a href="#" title="">
                	<span class="heading">DESERT</span>
                	<img src="{{ MEDIA_URL }}images/template/bookdesert.png" />
                </a>
            </div>
            <div class="name"><a class="add-item" href="#" id="7">Desert</a></div>
            <div class="description2">Fel principal pe baza de legume ( fara carne)<br/>Preparate cu pui<br/>Preparate cu carne de peste<br/>Peparate cu carne de vita<br/>Preparate cu carne de porc<br/>Preparate cu carne vanat<br/>Specialiati culinare</div>
          	<div class="click2eat">
            	<span class="recom">Recomandari supe si ciorbe</span>
            <div class="restaurante">
            	RESTAURANT <strong>PRESIDENT</strong><br/>
                RESTAURANT <strong>ALEXANDRE</strong>
            </div>
            </div>
            <div class="clear"></div>
        </div>          
    </div>
	</div>
    <br/><br/>
</div>
 
<!-- lista de restaurante dintr-un oras --> 
    <br/><br/>
<div class="content_area720"> 
	<div id="paginarestaurant">  
	<div class="title"><h1 class="light_orange">{% trans 'LISTA RESTAURANTE TIMISOARA' %}</h1></div>
    <br/>
    <div class="lista">
        <div class="item pozrel bgrest1">
            <div class="name2">
            	<a class="" href="#" >RESTAURANT PRESIDENT</a>
                <span class="special"></span>
                </div>
            
            <div class="description3">Specific italian, 200 locuri, specialitati</div>

            <div class="stele"></div>
            <a href="#" class="btnviziteaza1">Viziteaza restaurantul</a>
            <div class="clear"></div>
        </div>      
        <div class="item pozrel bgrest1">
            <div class="name2">
            	<a class="" href="#" >RESTAURANT COCO JAMBO</a>
            </div>
            
            <div class="description3">Specific italian, 200 locuri, specialitati, meniul zilei 14 lei</div>

            <div class="stele"></div>
            <a href="#" class="btnviziteaza1">Viziteaza restaurantul</a>
            <div class="clear"></div>
        </div>      
        <div class="item pozrel bgrest2">
            <div class="name2">
            	<a class="" href="#" >RESTAURANT PROVINCIAL</a>
            	<span class="special"></span> 
            </div>
            <div class="description3">Specific suedez</div>

            <div class="stele"></div>
            <a href="#" class="btnviziteaza1">Viziteaza restaurantul</a>
            <div class="clear"></div>
        </div>    
        <div class="item pozrel bgrest2">
            <div class="name2"><a class="" href="#" >RESTAURANT PICOLLO</a></div>
            <div class="description3">Specific italian, 200 locuri, specialitati, meniul zilei 14 lei</div>
            <a href="#" class="btnviziteaza1">Viziteaza restaurantul</a>
            <div class="clear"></div>
        </div>        
    <br/><br/>
    
       <div class="item pozrel bgrest3">
            <div class="name2"><a class="" href="#" >RESTAURANT PRESIDENT</a></div>
            <div class="description3">Specific italian, 200 locuri, specialitati, meniul zilei 14 lei</div>
            <a href="#" class="btnviziteaza2">Viziteaza restaurantul</a>
            <div class="clear"></div>
        </div>    
        <div class="item pozrel bgrest3">
            <div class="name2"><a class="" href="#" >RESTAURANT RATATATATATA</a></div>
            <div class="description3">Specific italian, 200 locuri, specialitati, meniul zilei 14 lei</div>
            <a href="#" class="btnviziteaza2">Viziteaza restaurantul</a>
            <div class="clear"></div>
        </div>    
       <div class="item pozrel bgrest3">
            <div class="name2"><a class="" href="#" >RESTAURANT MIRO</a></div>
            <div class="description3">Specific italian, 200 locuri, specialitati, meniul zilei 14 lei</div>
            <a href="#" class="btnviziteaza2">Viziteaza restaurantul</a>
            <div class="clear"></div>
        </div>            
	</div>
	</div>  
    <br/><br/>
</div>  
           
   <div class="content_area720">
        <div class="title"><h1 class="light_green">{{ object.name }}{% trans ' details' %}</h1></div>
        <br/>
        <div id="establishment_details">
            <strong>{% trans 'Name' %}:</strong> {{ object.name }}<br/>
            <strong>{% trans 'Address' %}:</strong> {{ object.address }}<br/>
            <strong>{% trans 'Email' %}:</strong> <a href="mailto:{{ object.email }}">{{ object.email }}</a><br/>
            <strong>{% trans 'Phone' %}:</strong> {{ object.phone }}<br/>
            <strong>{% trans 'Open hours' %}:</strong> {{ object.schedule }}, {% trans 'Open' %}: {{ object.schedule.is_open|yesno }}
        <br/>
            {% if object.info %}<strong>{% trans 'Info' %}:</strong> {{ object.info|safe }}<br/>{% endif %}
        </div>
        {% if object.logo_path %}
            <div id="establishment_picture">
                <img height="100" src="{{ MEDIA_URL }}{{ object.logo_path }}" alt="logo"/>
            </div>
        {% endif %}
        <div class="clear"></div>
        <div class="general_button">
            <a id="show-previous-link" href="#">{% trans 'Previous orders at this restaurant' %}</a>
        </div>
        <div class="clear"></div>
        <div id="last-orders" style="display:none"></div>
        <div class="clear"></div>
    </div><!-- content_area -->

    <div class="content_area720">
        <div class="title"><h1 class="light_green">{% trans 'Current Order' %}</h1></div>
        <br/>
        <div id="carts">
            <ul class="css-tabs">
                {% for cartname in carts %}
                    <li><a id="cart-{{ cartname }}" href="{% url order:get_cart order.id cartname %}">{{ cartname }}</a>
                    </li>
                {% empty %}
                    <li><a id="cart-{{ user.username }}"
                           href="{% url order:get_cart order.id user.username %}">{{ user.username }} </a></li>
                {% endfor %}
            </ul>
            <div class="css-panes">
                <div style="display:block"></div>
            </div>
            <div class="dual_button">
                <div class="left {{ object.schedule.is_open|yesno:',closed'}}">
                    <a href="{% url order:send object.id %}">{% trans 'Preview order' %}</a>
                </div>
                <div class="right">
                    <a id="add-cart" href="#">{% trans 'Add cart' %}</a>
                </div>
            </div>
        </div><!-- carts -->
    </div><!-- content_area -->
{% endblock %}

