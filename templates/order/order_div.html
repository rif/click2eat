{% load i18n %}
{% load order_tags %}

<h1>{% trans 'Order details' %}</h1>
<ul>
<li>{% trans 'Unit' %}: {{ order.unit }}</li>
<li>{% trans 'Creation date' %}: {{ order.creation_date }}</li>
<li>{% trans 'Status' %}: {{ order.get_status_display }}</li>
<li>{% trans 'Total amount' %}: {{ order.total_amount }}</li>
</ul>

<script type="text/javascript">
$(function(){
  $(".remove-orderitem").click(function(e){
    $.get($(this).attr("href"));
    $(this).parent().fadeOut();
    $("#order-total-amount").load("{% url order:get_total_amount order.id %}");
    $("#cart-subtotal-amount").load($("#cart-subtotal-amount").attr("href"));
    e.preventDefault();
  });
})
</script>

<div id="order-items">
<h2>{% trans 'Order Items' %}</h2>
<ul>
{% for cartname, oil in order.get_carts.items %}
<h3>{% trans 'Order items for' %} {{ cartname }}</h3>
 {% for oi in oil %}
    <li>{{ oi }} {% if order.status == 'CR' %}<a class="remove-orderitem" href="{% url order:remove_item oi.id %}">{% trans 'Remove' %}</a>{% endif %}</li>
 {% empty %}
    <li>{% trans 'There are no order items for' %} {{cartname}}</li>
 {% endfor %}
 <b>{% trans 'Cart subtotal' %}: <span id="cart-subtotal-amount" href="{% url order:get_subtotal order.unit.id cartname %}">{% get_cart_subtotal %}<span></b>
{% endfor %}
</ul>
</div>

<h4>{% trans 'Total ammount' %}: <span id="order-total-amount">{{ order.total_amount }}</span></h4>
